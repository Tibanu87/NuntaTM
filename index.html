<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Poze de la NuntÄƒ</title>
  <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.0"></script>
  <style>
    /* ... aici pÄƒstrezi tot CSS-ul tÄƒu original ... */
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ’• Poze NuntÄƒ Maria si Tiberiu ğŸ’•</h1>
      <p>ÃmpÄƒrtÄƒÈ™eÈ™te momentele frumoase cu noi adÄƒugÃ¢nd poze cu voi!ğŸ’•â¤ï¸</p>
    </div>
    
    <div class="content">
      <div id="welcomeForm" class="welcome-form">
        <h3>BunÄƒ ziua! VÄƒ rugÄƒm sÄƒ vÄƒ introduceÈ›i numele:</h3>
        <div class="form-group">
          <label for="guestName">Numele dumneavoastrÄƒ:</label>
          <input type="text" id="guestName" placeholder="ex: Ana È™i Mihai Popescu">
        </div>
        <button class="btn" onclick="setGuestName()">ConfirmÄƒ</button>
      </div>

      <div id="mainApp" class="hidden">
        <div id="welcomeMessage" class="welcome-message">
          <strong>Bun venit!</strong> Acum puteÈ›i adÄƒuga poze È™i vedea pozele celorlalÈ›i invitaÈ›i.
        </div>

        <div class="photo-upload">
          <h3>ğŸ“¸ AdaugÄƒ o pozÄƒ nouÄƒ</h3>
          <div class="form-group">
            <label for="photoInput">SelecteazÄƒ poza:</label>
            <input type="file" id="photoInput" accept="image/*" multiple>
          </div>
          <button class="btn" onclick="uploadPhotos()">ÃncarcÄƒ Pozele</button>
        </div>

        <div class="gallery-section">
          <h3 style="color: #8b7355; margin-bottom: 20px;">ğŸ“· Galeria Foto</h3>
          <div id="photoGallery" class="gallery"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===============================
    // CONFIGURARE APPWRITE
    // ===============================
    const client = new Appwrite.Client()
      .setEndpoint('https://cloud.appwrite.io/v1') // endpoint Appwrite Cloud
      .setProject('68b1d9c5002d64986cc4'); // Project ID-ul tÄƒu

    const storage = new Appwrite.Storage(client);
    const bucketId = '68b1da9b002d5fd5fe09'; // Bucket ID-ul tÄƒu

    // ===============================
    // VARIABILE LOCALE
    // ===============================
    let currentGuest = '';
    let photos = [];
    let currentPhotoIndex = 0;

    // ===============================
    // LOGICA APLICAÈšIEI
    // ===============================
    function setGuestName() {
      const nameInput = document.getElementById('guestName');
      const name = nameInput.value.trim();
      if (name === '') {
        alert('VÄƒ rugÄƒm sÄƒ introduceÈ›i numele!');
        return;
      }
      currentGuest = name;
      document.getElementById('welcomeForm').classList.add('hidden');
      document.getElementById('mainApp').classList.remove('hidden');
      document.getElementById('welcomeMessage').innerHTML =
        `<strong>Bun venit, ${currentGuest}!</strong> Acum puteÈ›i adÄƒuga poze È™i vedea pozele celorlalÈ›i invitaÈ›i.`;
    }

    async function uploadPhotos() {
      const photoInput = document.getElementById('photoInput');
      const files = photoInput.files;
      if (files.length === 0) {
        alert('SelecteazÄƒ cel puÈ›in o pozÄƒ!');
        return;
      }

      for (let i = 0; i < files.length; i++) {
        const file = files[i];
        try {
          const response = await storage.createFile(
            bucketId,
            Appwrite.ID.unique(),
            file
          );

          // CreeazÄƒ URL public pentru vizualizare
          const fileUrl =
            client.config.endpoint +
            '/storage/buckets/' + bucketId +
            '/files/' + response.$id +
            '/view?project=' + client.config.project;

          photos.unshift({
            id: Date.now() + i,
            src: fileUrl,
            guestName: currentGuest,
            uploadTime: new Date().toLocaleString('ro-RO'),
            originalName: file.name
          });
        } catch (error) {
          console.error("Eroare upload:", error);
          alert("Eroare la Ã®ncÄƒrcarea fiÈ™ierului: " + file.name);
        }
      }

      displayPhotos();
      alert(`${files.length} poze au fost Ã®ncÄƒrcate cu succes Ã®n Appwrite!`);
      photoInput.value = '';
    }

    function displayPhotos() {
      const gallery = document.getElementById('photoGallery');
      if (photos.length === 0) {
        gallery.innerHTML =
          '<p style="text-align: center; color: #999; grid-column: 1/-1;">ÃncÄƒ nu au fost Ã®ncÄƒrcate poze. FiÈ›i primul care adaugÄƒ o pozÄƒ!</p>';
        return;
      }
      gallery.innerHTML = photos.map((photo, index) => `
        <div class="photo-item" onclick="openModal(${index})">
          <img src="${photo.src}" alt="PozÄƒ de la nuntÄƒ" loading="lazy">
          <div class="photo-info">
            <div class="guest-name">${photo.guestName}</div>
            <div class="upload-time">${photo.uploadTime}</div>
          </div>
        </div>
      `).join('');
    }

    // ===============================
    // MODAL FOTO (dacÄƒ vrei sÄƒ-l pÄƒstrezi)
    // ===============================
    function openModal(photoIndex) {
      currentPhotoIndex = photoIndex;
      const photo = photos[photoIndex];
      alert(`PozÄƒ de la ${photo.guestName}, Ã®ncÄƒrcatÄƒ la ${photo.uploadTime}`);
    }
  </script>
</body>
</html>
